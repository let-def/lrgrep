\makeatletter

\newcommand{\ixdef}[4]{
  {\expandafter\gdef\csname ix@#1 \endcsname{#2}}
  {\expandafter\xdef\csname ix@#1@file \endcsname{#3}}
  {\expandafter\xdef\csname ix@#1@line \endcsname{#4}}
}

\newcommand{\ixlabel}[3]{\ixdef{#1}{\ixloc{}}{#2}{#3}}

\newcommand{\ixref}[1]{%
  \ifcsname ix@#1 \endcsname%
    {\def\ixcur{#1} \csname ix@#1 \endcsname}%
  \else%
    {\em undefined ixref: \textbf{#1} \undefined}%
\fi}

\newcommand{\ixfile}[1][\ixcur]{\csname ix@#1@file \endcsname}
\newcommand{\ixline}[1][\ixcur]{\csname ix@#1@line \endcsname}
\newcommand{\ixloc}[1][\ixcur]{%
\begingroup%
\edef\x{https://github.com/let-def/lrgrep/blob/\ixrevision/\csname ix@#1@file \endcsname\#L\csname ix@#1@line \endcsname}%
\href\x{\ixfile:\ixline}%
\endgroup}

\makeatother
